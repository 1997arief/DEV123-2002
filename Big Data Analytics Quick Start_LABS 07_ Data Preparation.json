{"paragraphs":[{"title":"0. Output Specification 1","text":"%sh\n## Output Specification\n## 1. ev_date\n## 2. id_hour\n## 3. id_user_type\n##    if usertype == 'Customer '\n##     then 1\n##    elseif usertype == 'Subscriber '\n##     then 2\n##    else 0\n## 4. id_bike\n## 5. duration\n## 6. usage","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1582047095131_-1491271928","id":"20200217-084259_633350863","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20790"},{"title":"1. Make sure, data is available","text":"%sh\nhdfs dfs -ls dataset/citibike","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095133_-949990609","id":"20200217-084401_1205335546","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20791"},{"title":"2. Read dataset","text":"%spark.pyspark\n\nimport pandas as pd\nimport datetime","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1582047095134_215184793","id":"20200217-084437_1496434079","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20792"},{"text":"%spark.pyspark\n\n#df_dataset = spark.read.csv(path='hdfs://10.1.80.221/user/yava/dataset/citibike/201611-citibike-tripdata.csv', header = True, inferSchema = True)\ndf_dataset = spark.read.csv(path='hdfs://192.168.56.103/user/yava/dataset/citibike/201611-citibike-tripdata.csv', header = True, inferSchema = True)","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095135_-20560816","id":"20200217-084536_1543553593","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20793"},{"text":"%spark.pyspark\ndf_dataset.show(5)","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095136_-1289555823","id":"20200217-084608_66325885","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20794"},{"text":"%spark.pyspark\n\ndf_dataset.printSchema()","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095137_1376705859","id":"20200217-084622_1534416532","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20795"},{"title":"3. Select column","text":"%spark.pyspark\ndf_stg01_selected = df_dataset.select('Start Time', 'User Type', 'Bike ID','Trip Duration')\n\ndf_stg01_selected.show(5)","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095138_1487914279","id":"20200217-084655_283422543","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20796"},{"title":"4. Rename column","text":"%spark.pyspark\ndf_stg02_selected = df_stg01_selected.withColumnRenamed(\"Start Time\", \"ev_datetime\")\\\n               .withColumnRenamed(\"User Type\", \"user_type\")\\\n               .withColumnRenamed(\"Trip Duration\", \"duration\")\\\n               .withColumnRenamed(\"Bike ID\", \"id_bike\")\n               \ndf_stg02_selected.show(5)","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095139_41302528","id":"20200217-085352_526130230","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20797"},{"title":"5. Reformat ev_datetime","text":"%spark.pyspark\nfrom pyspark.sql.functions import hour\nfrom pyspark.sql.functions import to_date\n\ndf_stg03_selected = df_stg02_selected.withColumn('ev_date', to_date(df_stg02_selected.ev_datetime))\\\n                                     .withColumn('id_hour', hour(df_stg02_selected.ev_datetime))\n\ndf_stg03_selected.show(5)","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095140_-1445681867","id":"20200217-085930_803293427","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20798"},{"text":"%spark.pyspark\ndf_stg03_selected.filter(\"id_hour = 2\").show(5)","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095141_-834471116","id":"20200217-091541_695960319","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20799"},{"title":"6. Reformat user_type","text":"%spark.pyspark\nfrom pyspark.sql.functions import when\n\ndf_stg04_selected = df_stg03_selected.withColumn('id_user_type', \\\n                                                            when(df_stg03_selected.user_type == 'Customer ', 1)\n                                                            .when(df_stg03_selected.user_type == 'Subscriber', 2)\n                                                            .otherwise(0)\n                                                )\n\ndf_stg04_selected.show(5)","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095142_-2112274985","id":"20200217-090623_2080282122","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20800"},{"title":"7. Group by ev_date, id_hour, id_user_type, id_bike","text":"%spark.pyspark\ndf_stg04_selected.groupBy(\"ev_date\", \"id_hour\", \"id_user_type\", \"id_bike\") \\\n           .agg({'*' : 'count', 'duration' : 'sum'} ) \\\n           .show(5)","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095143_1323825289","id":"20200217-091757_19332038","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20801"},{"title":"","text":"%spark.pyspark\ndf_stg05_selected = df_stg04_selected.groupBy(\"ev_date\", \"id_hour\", \"id_user_type\", \"id_bike\") \\\n                                     .agg({'*' : 'count', 'duration' : 'sum'} ) \\\n                                     .toDF('ev_date', 'id_hour', 'id_user_type', 'id_bike', 'duration', 'usage')\n                                     \ndf_stg05_selected.show(5)","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095144_-1497450491","id":"20200217-092135_914564093","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20802"},{"title":"8. Save result as H_BIKE_USG","text":"%spark.pyspark\ndf_stg05_selected.rdd.getNumPartitions()","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095145_903193567","id":"20200217-092436_1558313725","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20803"},{"text":"%spark.pyspark\n\ndf_stg05_selected.repartition(1).write.csv(\"hdfs://192.168.56.103/user/yava/dataset/h_bike_usg\", sep='|', header = 'true'","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095146_-1943189472","id":"20200218-111354_1406382698","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20804"},{"text":"%sh\n#hdfs dfs -rm -r dataset/h_bike_usg\n","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095147_595977927","id":"20200218-111157_1281747698","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20805"},{"text":"%sh\nhdfs dfs -ls dataset/h_bike_usg","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095148_-1626087679","id":"20200217-095422_30594012","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20806"},{"text":"%sh\nhadoop fs -cat dataset/h_bike_usg/part-00000-0c985f12-fad2-4dc5-a98d-a812bf673ecb-c000.csv | head","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095149_-1622201410","id":"20200217-095451_1131147824","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20807"},{"title":"Output Specification 2","text":"%sh\n## dteday\n## season\n## yr : year - 2011\n## mnth\n## hr\n## holiday\n## weekday :  0 --> sunday, 1--> monday\n## workingday : if (is_holiday == 0) and (day_of_week between 1 and 5) then set to 1 else set to 0\n## weathersit\n## temp\n## atem\n## hum\n## wind_speed\n## casual\n## registered\n## cnt\n\n# +-------------------+------+---+----+---+-------+-------+----------+----------+----+------+----+---------+------+----------+---+\n# |             dteday|season| yr|mnth| hr|holiday|weekday|workingday|weathersit|temp| atemp| hum|windspeed|casual|registered|cnt|\n# +-------------------+------+---+----+---+-------+-------+----------+----------+----+------+----+---------+------+----------+---+\n# |2011-01-01 00:00:00|     1|  0|   1|  0|      0|      6|         0|         1|0.24|0.2879|0.81|      0.0|     3|        13| 16|\n# |2011-01-01 00:00:00|     1|  0|   1|  1|      0|      6|         0|         1|0.22|0.2727| 0.8|      0.0|     8|        32| 40|\n# |2011-01-01 00:00:00|     1|  0|   1|  2|      0|      6|         0|         1|0.22|0.2727| 0.8|      0.0|     5|        27| 32|\n# |2011-01-01 00:00:00|     1|  0|   1|  3|      0|      6|         0|         1|0.24|0.2879|0.75|      0.0|     3|        10| 13|\n# |2011-01-01 00:00:00|     1|  0|   1|  4|      0|      6|         0|         1|0.24|0.2879|0.75|      0.0|     0|         1|  1|\n# +-------------------+------+---+----+---+-------+-------+----------+----------+----+------+----+---------+------+----------+---+\n","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095150_212220525","id":"20200217-095656_1581585138","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20808"},{"text":"%spark.pyspark\ndf_stg05_selected.show(5)","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095151_-1761210687","id":"20200217-095416_594564392","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20809"},{"title":"9. Transform all column related to ev_date","text":"%spark.pyspark\nfrom pyspark.sql.functions import to_timestamp\n\ndf_stg05_selected.withColumn('dteday', to_timestamp(df_stg05_selected.ev_date, \"yyyy-MM-dd HH:mm:ss\"))\\\n                 .show(5)","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095152_-24644401","id":"20200217-101735_1992573809","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20810"},{"text":"%spark.pyspark\ndf_stg05_selected.show(5)","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095153_-319965524","id":"20200217-104706_875180236","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20811"},{"text":"%spark.pyspark\nfrom pyspark.sql.functions import substring, date_format\nfrom pyspark.sql.types import IntegerType\n\ndf_stg06_selected = df_stg05_selected.withColumn( 'dteday', to_timestamp(df_stg05_selected.ev_date, \"yyyy-MM-dd HH:mm:ss\") ) \\\n                 .withColumn( 'yr', substring(df_stg05_selected.ev_date, 1, 4).cast(IntegerType()) - 2011 ) \\\n                 .withColumn( 'mnth', date_format(df_stg05_selected.ev_date, 'M') )\\\n                 .withColumn( 'dayname', date_format(df_stg05_selected.ev_date, 'E') )\\\n                 .withColumn( 'weekday', \n                                       when(date_format(df_stg05_selected.ev_date, 'E') == 'Sun', 0)\n                                       .when(date_format(df_stg05_selected.ev_date, 'E') == 'Mon', 1)\n                                       .when(date_format(df_stg05_selected.ev_date, 'E') == 'Tue', 2)\n                                       .when(date_format(df_stg05_selected.ev_date, 'E') == 'Wed', 3)\n                                       .when(date_format(df_stg05_selected.ev_date, 'E') == 'Thu', 4)\n                                       .when(date_format(df_stg05_selected.ev_date, 'E') == 'Fri', 5)\n                                       .otherwise(6)\n                            ) \\\n                 .withColumn( 'casual', when(df_stg05_selected.id_user_type == 1, df_stg05_selected.usage)\n                                        .otherwise(0)\n                            )\\\n                 .withColumn( 'registered', when(df_stg05_selected.id_user_type == 2, df_stg05_selected.usage)\n                                        .otherwise(0)\n                            )\n                            \ndf_stg06_selected.show(5)\n","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095154_-135133469","id":"20200217-101907_1516374427","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20812"},{"text":"%spark.pyspark\ndf_stg07_selected = df_stg06_selected.select('dteday', 'yr', 'mnth', 'id_hour', 'weekday', 'casual', 'registered').withColumnRenamed('id_hour', 'hr')\ndf_stg07_selected.show(5)","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095155_1512435948","id":"20200218-120748_1173188675","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20813"},{"title":"10. Prepare weather data","text":"%sh\nhdfs dfs -ls dataset\n#hdfs dfs -rm dataset/dataset-weather2016.cvs","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095156_804003970","id":"20200218-112530_555232391","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20814"},{"text":"%sh\nls -la dataset\n","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095157_1236675981","id":"20200218-114540_1342151001","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20815"},{"text":"%sh\nhdfs dfs -put dataset/dataset-weather2016.csv dataset","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095158_-338309918","id":"20200218-114601_61649517","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20816"},{"text":"%spark.pyspark\ndf_weather = spark.read.csv(path='hdfs://192.168.56.103/user/yava/dataset/dataset-weather2016.csv', header = True, inferSchema = True, sep='|')","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1582047095159_106514565","id":"20200218-114837_1963675558","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20817"},{"text":"%spark.pyspark\ndf_weather.show(5)\ndf_weather.printSchema()","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095160_478275968","id":"20200217-103028_697946524","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20818"},{"title":"Join with weather and dataset","text":"%spark.pyspark\ndf_stg07_selected.show(5)","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095161_2011843029","id":"20200217-110448_1667255225","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20819"},{"text":"%spark.pyspark\n## dteday\n## season\n## yr : year - 2011\n## mnth\n## hr\n## holiday\n## weekday :  0 --> sunday, 1--> monday\n## workingday : if (is_holiday == 0) and (day_of_week between 1 and 5) then set to 1 else set to 0\n## weathersit\n## temp\n## atem\n## hum\n## wind_speed\n## casual\n## registered\n## cnt","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095162_1613933895","id":"20200218-121957_1224943732","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20820"},{"text":"%spark.pyspark\ndf_stg07_selected.join(df_weather, (df_stg07_selected.dteday == df_weather.ev_date) & (df_stg07_selected.hr == df_weather.hr)) \\\n           .orderBy(df_stg07_selected.dteday) \\\n           .select('dteday', 'yr', 'mnth', df_stg07_selected.hr, 'weekday', 'weathersit', 'temp', 'atemp', 'hum', 'windspeed', 'casual', 'registered' )\\\n           .show(5)","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095163_422305724","id":"20200218-120526_1391864539","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20821"},{"text":"%spark.pyspark\n","user":"yava","dateUpdated":"2020-02-18T12:31:35-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582047095164_-389096468","id":"20200218-121706_333329418","dateCreated":"2020-02-18T12:31:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20822"}],"name":"Big Data Analytics Quick Start/LABS 07: Data Preparation","id":"2F3F7ARMW","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:yava:":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}